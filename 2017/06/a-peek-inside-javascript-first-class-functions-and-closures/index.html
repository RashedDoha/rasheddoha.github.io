<!doctype html><html lang=en><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1"><link rel="shortcut icon" href=/images//circle.ico><link href="https://fonts.googleapis.com/css2?family=Nunito+Sans:ital,wght@0,400;1,200&display=swap" rel=stylesheet><link rel=stylesheet href=https://cdnjs.cloudflare.com/ajax/libs/normalize/8.0.1/normalize.min.css><link rel=stylesheet href=/css/main.css><title>An internet page | A peek inside JavaScript: First-class functions and Closures</title></head><body><div class=container><nav class="navbar mb-5" role=navigation aria-label="main navigation"><div class=navbar-brand><a role=button class=navbar-burger data-target=navMenu aria-label=menu aria-expanded=false><span aria-hidden=true></span><span aria-hidden=true></span><span aria-hidden=true></span></a></div><div id=navMenu class=navbar-menu><div class=navbar-start><a class=navbar-item href=/>About</a>
<a class=navbar-item href=/posts>Blog</a>
<a class=navbar-item href=/news>News</a>
<a class=navbar-item href=/stuff>Stuff</a></div><div class=navbar-end><div class=navbar-item><span class="social-btn mr-3"><a href=https://twitter.com/RashedDoha target=_blank><i data-feather=twitter></i></a></span><span class="social-btn mr-3"><a href=https://github.com/RashedDoha target=_blank><i data-feather=github></i></a></span><span class="social-btn mr-3"><a href=https://linkedin.com/in/rasheddoha target=_blank><i data-feather=linkedin></i></a></span></div></div></div></nav><div class="has-text-centered page-title"><p class=title style=font-weight:400>A peek inside JavaScript: First-class functions and Closures</p></div><hr><section><section class=item-list style="max-width:800px;margin:0 auto"><i data-feather=calendar></i><time datetime=2017-06-24>Jun 24, 2017</time><br><br><p><img src=images/peek-inside-js.jpeg alt=Javascript></p><p>One of the best ways to learn a new programming language is to ask yourself two important questions-</p><ol><li>What makes this language different?</li><li>What do I need it for?</li></ol><p>Probably the first thing that comes to mind when talking about JavaScript as a programming language is its event-driven architecture. Simply put, this means that even after the script has run, the code lives in memory allowing it to respond to events. And this ability of jumping to a specific function in the script makes it seem like it’s executing hundreds of lines of code blazing fast. This makes it the perfect choice for developing event-driven real time applications as is the case with NodeJs. This is something that makes JavaScript <strong>Awesome</strong> but also <em>Weird</em>&mldr; here’s why.</p><p>Consider the following event handler that responds to a click</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-js data-lang=js><span style=color:#66d9ef>var</span> <span style=color:#a6e22e>count</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>;
<span style=color:#66d9ef>var</span> <span style=color:#a6e22e>button</span> <span style=color:#f92672>=</span> document.<span style=color:#a6e22e>getElementById</span>(<span style=color:#e6db74>&#39;button&#39;</span>);
<span style=color:#a6e22e>button</span>.<span style=color:#a6e22e>addEventListener</span>(<span style=color:#e6db74>&#39;click&#39;</span>, <span style=color:#66d9ef>function</span>() {
  <span style=color:#a6e22e>count</span><span style=color:#f92672>++</span>;
  <span style=color:#a6e22e>alert</span>(<span style=color:#a6e22e>count</span>);
});
</code></pre></div><p>All this does is increment a global counter variable every time a button is clicked. Simple enough. Even after the script has run, the function can be called in response to an event and it has access to the global variable because it exists in memory. But it’s always good practice to use local variables whenever possible. So let’s look at how that could be.</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-js data-lang=js><span style=color:#66d9ef>var</span> <span style=color:#a6e22e>button</span> <span style=color:#f92672>=</span> document.<span style=color:#a6e22e>getElementById</span>(<span style=color:#e6db74>&#39;button&#39;</span>);
<span style=color:#a6e22e>button</span>.<span style=color:#a6e22e>addEventListener</span>(<span style=color:#e6db74>&#39;click&#39;</span>, <span style=color:#66d9ef>function</span>() {
  <span style=color:#66d9ef>var</span> <span style=color:#a6e22e>count</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>;
  <span style=color:#a6e22e>count</span><span style=color:#f92672>++</span>;
  <span style=color:#a6e22e>alert</span>(<span style=color:#a6e22e>count</span>);
});
</code></pre></div><p>But this won’t work, because obviously the local variable inside the function will always be reset to 0 every time the event fires. So we need to approach this a little differently.<br>\</p><h3 id=first-class-functions-are-just-like-primitives-and-objects>“First-class functions are just like primitives and objects”</h3><p>In JavaScript functions are treated as <a href=https://en.wikipedia.org/wiki/First-class_citizen><em>first-class-citizens</em></a>. What this basically means is that just like primitive values and objects, functions can be</p><ul><li>Assigned to variables</li><li>Returned from functions</li><li>Passed as arguments to functions</li></ul><p>This helps us solve our problem by returning a
function from a function that will have access to a variable from it’s parent function. This might start to sound like a script from the movie Inception, but it’s simple once you wrap your head around it. Let’s look at what I mean</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-js data-lang=js><span style=color:#66d9ef>var</span> <span style=color:#a6e22e>button</span> <span style=color:#f92672>=</span> document.<span style=color:#a6e22e>getElementById</span>(<span style=color:#e6db74>&#39;button&#39;</span>);
<span style=color:#75715e>// First we create a function that has the local variable count inside it
</span><span style=color:#75715e></span><span style=color:#66d9ef>var</span> <span style=color:#a6e22e>parentFunction</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>function</span>() {
  <span style=color:#66d9ef>var</span> <span style=color:#a6e22e>count</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>; <span style=color:#75715e>// Local variable inside the function
</span><span style=color:#75715e>// Now we define a child function inside this function that will increment the count variable
</span><span style=color:#75715e></span>  <span style=color:#66d9ef>var</span> <span style=color:#a6e22e>newFunc</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>function</span>() {
    <span style=color:#a6e22e>count</span><span style=color:#f92672>++</span>; <span style=color:#75715e>// child function increments the parent&#39;s variable
</span><span style=color:#75715e></span>    <span style=color:#a6e22e>alert</span>(<span style=color:#a6e22e>count</span>);
  }
  
  <span style=color:#75715e>// Finally we return this child function when we execute the parent function
</span><span style=color:#75715e></span>  <span style=color:#66d9ef>return</span> <span style=color:#a6e22e>newFunc</span>;
  
  
  
}
<span style=color:#a6e22e>button</span>.<span style=color:#a6e22e>addEventListener</span>(<span style=color:#e6db74>&#39;click&#39;</span>, <span style=color:#a6e22e>parentFunction</span>()); <span style=color:#75715e>// Invoking the parent function so it returns the child function as the argument to the event handler
</span></code></pre></div><p>The event handler in the code accepts an event as the first and a function as the second argument.</p><p>As the second argument, we pass the invocation of the parent function so essentially we pass in the child function it returns as the second argument to the event handler. It’s important to note that the parent function isn’t returning the execution of the child function. It’s returning a reference to the child function so it can be executed whenever deemed necessary to do so.</p><p>So the idea of first-class functions provide a lot of flexibility in the case of how we conventionally think about functions as return values vs an actual object with properties and behavior.</p><p>Now if you examine the code above, something seems a bit off. Once the parent function runs, and returns the new child function, we are essentially out of the execution context of the parent function and thus should not have access to its local variables. So after a function has run, trying to access any of its local variables should cause a null pointer exception or in JavaScript terms, the value of undefined. So how is it, that the child function can increment the parent’s counter variable as if it’s a global variable? That’s where closures come in.</p><h3 id=a-closure-is-a-function-plus-its-immediate-environment-or-lexical-scope>“A closure is a function plus its immediate environment or lexical scope”</h3><p>Contrary to the scoping rules imposed on functions in many of the other languages, JavaScript functions have lexical scope. Meaning that regardless of the execution context of a function, it’s scope will always be the scope defined in the way the script is written. The word lexical basically means what you can see. So in code, the variables you can see a function have access to by the way it’s written, is the variables it will have access to as part of its scope- regardless of the context in which it is run. These two concepts of first-class functions and closures are two of the three most confusing parts of JavaScript for someone coming from a language background like Java or C++. The third one is how the “this” keyword is bound to values. That deserves a separate writing of its own.</p><p>Despite the initial confusion surrounding closures, it can be a very effective tool for writing clever and efficient code, if used correctly.</p><p>I’ve written a pen for this topic for those interested-</p><script data-slug-hash=KqvLgV data-user=RashedDoha data-height=500 data-default-tab=js data-theme-id=8862 class=codepen async src=//codepen.io/assets/embed/ei.js></script><hr><div id=disqus_thread></div><script type=application/javascript>var disqus_config=function(){};(function(){if(["localhost","127.0.0.1"].indexOf(window.location.hostname)!=-1){document.getElementById('disqus_thread').innerHTML='Disqus comments not available by default when the website is previewed locally.';return;}
var d=document,s=d.createElement('script');s.async=true;s.src='//'+"rasheddoha-github-io"+'.disqus.com/embed.js';s.setAttribute('data-timestamp',+new Date());(d.head||d.body).appendChild(s);})();</script><noscript>Please enable JavaScript to view the <a href=https://disqus.com/?ref_noscript>comments powered by Disqus.</a></noscript><a href=https://disqus.com class=dsq-brlink>comments powered by <span class=logo-disqus>Disqus</span></a></section></section></div><div class="footer text-center"><p>Copyright (c) 2021 Rashed Doha |
<a href=# class=mute><u>Contact</u></a></p></div><script src=/js/main.js></script><script src=/js/feather.min.js></script><script>feather.replace()</script></body></html>